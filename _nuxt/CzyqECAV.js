import{i as b,u as k,a as w,p as h,m as E}from"./MZpCfQwu.js";import{d as S,z as B,y as z,l as u,A as I,B as C,c as L,f as P,o as N,C as A,x as n,D as $}from"./C_-Ao5nl.js";const q=["src"],M=S({__name:"NuxtImg",props:b,emits:["load","error"],setup(y,{emit:_}){const s=y,p=B(),a=_,v=!1,c=k(),t=w(s),i=z(!1),o=z(),l=u(()=>c.getSizes(s.src,{...t.options.value,sizes:s.sizes,densities:s.densities,modifiers:{...t.modifiers.value,width:h(s.width),height:h(s.height)}})),f=u(()=>{const e={...t.attrs.value,"data-nuxt-img":""};return(!s.placeholder||i.value)&&(e.sizes=l.value.sizes,e.srcset=l.value.srcset),e}),d=u(()=>{let e=s.placeholder;if(e===""&&(e=!0),!e||i.value)return!1;if(typeof e=="string")return e;const r=Array.isArray(e)?e:typeof e=="number"?[e,e]:[10,10];return c(s.src,{...t.modifiers.value,width:r[0],height:r[1],quality:r[2]||50,blur:r[3]||3},t.options.value)}),m=u(()=>s.sizes?l.value.src:c(s.src,t.modifiers.value,t.options.value)),g=u(()=>d.value?d.value:m.value),x=I().isHydrating;return C(()=>{if(d.value||s.custom){const e=new Image;m.value&&(e.src=m.value),s.sizes&&(e.sizes=l.value.sizes||"",e.srcset=l.value.srcset),e.onload=r=>{i.value=!0,a("load",r)},e.onerror=r=>{a("error",r)},E("nuxt-image");return}o.value&&(o.value.complete&&x&&(o.value.getAttribute("data-error")?a("error",new Event("error")):a("load",new Event("load"))),o.value.onload=e=>{a("load",e)},o.value.onerror=e=>{a("error",e)})}),(e,r)=>e.custom?P(e.$slots,"default",$(A({key:1},{...n(v)?{onerror:"this.setAttribute('data-error', 1)"}:{},imgAttrs:{...f.value,...n(p)},isLoaded:i.value,src:g.value}))):(N(),L("img",A({key:0,ref_key:"imgEl",ref:o,class:s.placeholder&&!i.value?s.placeholderClass:void 0},{...n(v)?{onerror:"this.setAttribute('data-error', 1)"}:{},...f.value,...n(p)},{src:g.value}),null,16,q))}});export{M as _};
