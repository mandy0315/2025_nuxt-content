import{_ as x}from"./ByIiT340.js";import{d as h,l as $,k as P,o as p,K as w,i as y,O as I,h as g,g as f,f as u,t as v,W as B,X as M,c as S,e as C,P as j,F as E,r as N,j as z,Y as b,S as D,Z as F}from"./BUqB5ooQ.js";import{_ as L}from"./DN2phSw8.js";import{_ as V}from"./DNB5shyy.js";const q=h({__name:"Image",props:{src:{},alt:{},fallback:{},imgClass:{}},setup(d){const t=d,s=$(t.src),i=()=>{s.value=t.fallback||"/images/default-image.jpg"};return(c,m)=>{const o=x;return p(),P(o,{src:y(s),alt:c.alt,class:w(c.imgClass),onError:i},null,8,["src","alt","class"])}}}),A={class:"w-full h-0 pb-[56.25%] relative rounded-lg overflow-hidden"},O={class:"p-2"},T={class:"text-xl"},Z=h({__name:"PostCard",props:{path:{},image:{},date:{},title:{},description:{}},setup(d){return(t,s)=>{const i=q,c=L,m=I;return p(),P(m,{to:t.path,class:"bg-gray-100 dark:bg-gray-100/10 border c-border-gray shadow-lg rounded-lg overflow-hidden group"},{default:g(()=>[f("div",A,[u(i,{src:t.image,fallback:"/images/default-image.jpg",alt:t.title,imgClass:"h-full transition object-center object-cover w-full absolute duration-500 ease-in-out group-hover:blur-sm group-hover:scale-110"},null,8,["src","alt"])]),f("div",O,[u(c,{date:t.date},null,8,["date"]),f("p",T,v(t.title),1),f("p",null,v(t.description),1)])]),_:1},8,["to"])}}}),K={class:"flex items-center justify-center py-6"},G=h({__name:"Pagination",props:B({totalPage:{},limitCount:{default:5}},{currentPage:{required:!0},currentPageModifiers:{}}),emits:["update:currentPage"],setup(d){const t=d,s=M(d,"currentPage"),i=o=>{(o>1||o<t.totalPage)&&(s.value=o)},c=o=>{i(s.value+o)},m=S(()=>{const o=Math.floor(t.limitCount/2);let l=s.value-o,r=s.value+o;return l<1&&(l=1,r=Math.min(t.totalPage,t.limitCount)),r>t.totalPage&&(r=t.totalPage,l=Math.max(1,r-t.limitCount+1)),Array.from({length:r-l+1},(a,e)=>l+e)});return(o,l)=>{const r=j,a=V;return p(),C("div",K,[u(a,{onClick:l[0]||(l[0]=e=>i(1)),class:"w-8 h-8 mx-0.5 inline-flex items-center",disabled:s.value===1},{default:g(()=>[u(r,{name:"solar:double-alt-arrow-left-linear",size:"1.3rem"})]),_:1},8,["disabled"]),u(a,{onClick:l[1]||(l[1]=e=>c(-1)),class:"w-8 h-8 mx-0.5 inline-flex items-center",disabled:s.value===1},{default:g(()=>[u(r,{name:"solar:alt-arrow-left-outline",size:"1.2rem"})]),_:1},8,["disabled"]),(p(!0),C(E,null,N(y(m),e=>(p(),P(a,{class:w(["w-8 h-8 mx-0.5",s.value===e?"bg-c-light-blue text-white":""]),key:e,onClick:n=>i(e)},{default:g(()=>[z(v(e),1)]),_:2},1032,["class","onClick"]))),128)),u(a,{onClick:l[2]||(l[2]=e=>c(1)),class:"w-8 h-8 mx-0.5 inline-flex items-center",disabled:s.value===o.totalPage},{default:g(()=>[u(r,{name:"solar:alt-arrow-right-outline",size:"1.2rem"})]),_:1},8,["disabled"]),u(a,{onClick:l[3]||(l[3]=e=>i(o.totalPage)),class:"w-8 h-8 mx-0.5 inline-flex items-center",disabled:s.value===o.totalPage},{default:g(()=>[u(r,{name:"solar:double-alt-arrow-right-linear",size:"1.3rem"})]),_:1},8,["disabled"])])}}}),H=()=>{const t=b("loading",()=>!1),s=b("posts",()=>({list:[],totalPosts:0})),i=a=>{if(["desc","asc"].includes(a))return a.toUpperCase();F({statusCode:404,statusMessage:"Page Not Found"})},c=async(a="DESC")=>{try{const e=await D("posts").order("date",a).select("title","path","categories","image","description","date").all();s.value.list=e,s.value.totalPosts=e.length}catch(e){console.error("取得文章錯誤",e)}},m=a=>{if(s.value.list.length===0)return;const n=s.value.list.filter(_=>_.categories.includes(a));n&&n.length>0&&(s.value.list=n,s.value.totalPosts=n.length)},o=(a=1,e=1)=>{const n=s.value.list;if(n.length===0)return;const _=Math.ceil(n.length/a),k=n.slice((e-1)*a,e*a);s.value={list:k,currentPage:e,totalPage:_,totalPosts:n.length}};return{updatePosts:async(a=1,e="desc")=>{t.value=!0;const n=i(e);await c(n||"DESC"),o(9,a),t.value=!1},posts:s,isLoading:t,updatePostsInCategory:async(a=1,e="")=>{t.value=!0,await c(),m(e),o(9,a),t.value=!1}}};export{Z as _,G as a,H as u};
