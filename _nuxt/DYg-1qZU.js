import{b as P,u as C,a as I,g as N,c as S,m as L}from"./MZpCfQwu.js";import{d as M,z as O,l as a,y as $,A as j,B as H,c,o as l,b as T,F as U,n as V,C as q,x as y}from"./C_-Ao5nl.js";const D=["type","sizes","srcset"],G=["src","sizes","srcset"],R=M({__name:"NuxtPicture",props:P,emits:["load","error"],setup(x,{emit:z}){const s=x,v=O(),n=z,_=!1,o=C(),{attrs:b,options:A,modifiers:h}=I(s),d=a(()=>N(s.src)),F=a(()=>["png","webp","gif","svg"].includes(d.value)),i=a(()=>s.legacyFormat?s.legacyFormat:F.value?"png":"jpeg"),p=a(()=>{var g,t;const e=((g=s.format)==null?void 0:g.split(","))||(d.value==="svg"?["svg"]:(t=o.options.format)!=null&&t.length?[...o.options.format]:["webp"]);return e[0]==="svg"?[{src:s.src}]:(e.includes(i.value)&&e.splice(e.indexOf(i.value),1),e.push(i.value),e.map(f=>{const{srcset:E,sizes:w,src:B}=o.getSizes(s.src,{...A.value,sizes:s.sizes||o.options.screens,densities:s.densities,modifiers:{...h.value,format:f}});return{src:B,type:`image/${f}`,sizes:w,srcset:E}}))}),u=a(()=>p.value[p.value.length-1]),m={...s.imgAttrs,"data-nuxt-pic":""};for(const e in v)e in S&&!(e in m)&&(m[e]=v[e]);const r=$(),k=j().isHydrating;return H(()=>{r.value&&(r.value.complete&&k&&(r.value.getAttribute("data-error")?n("error",new Event("error")):n("load",new Event("load"))),r.value.onload=e=>{n("load",e)},r.value.onerror=e=>{n("error",e)},L("nuxt-picture"))}),(e,g)=>(l(),c("picture",null,[(l(!0),c(U,null,V(p.value.slice(0,-1),t=>(l(),c("source",{key:t.src,type:t.type,sizes:t.sizes,srcset:t.srcset},null,8,D))),128)),u.value?(l(),c("img",q({key:0,ref_key:"imgEl",ref:r},{...y(b),...y(_)?{onerror:"this.setAttribute('data-error', 1)"}:{},...m},{src:u.value.src,sizes:u.value.sizes,srcset:u.value.srcset}),null,16,G)):T("",!0)]))}});export{R as default,P as pictureProps};
